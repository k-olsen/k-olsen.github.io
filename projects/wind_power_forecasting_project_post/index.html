<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Hugo 0.83.1" />

  <title>LSTM for time-series forecasting: predicting wind-power generation &middot; Kira Olsen, Ph.D.</title>

  <meta name="description" content="" />

  

<meta itemprop="name" content="LSTM for time-series forecasting: predicting wind-power generation">
<meta itemprop="description" content="Time-series forecasting has tons of applications. If we have a record of how something has changed with time in the past, the next step is often to wonder about how the same variable will change in the future."><meta itemprop="datePublished" content="2021-08-24T01:00:40-04:00" />
<meta itemprop="dateModified" content="2021-08-24T01:00:40-04:00" />
<meta itemprop="wordCount" content="1044"><meta itemprop="image" content="https://k-olsen.github.io/images/profile.png"/>
<meta itemprop="keywords" content="" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://k-olsen.github.io/images/profile.png"/>

<meta name="twitter:title" content="LSTM for time-series forecasting: predicting wind-power generation"/>
<meta name="twitter:description" content="Time-series forecasting has tons of applications. If we have a record of how something has changed with time in the past, the next step is often to wonder about how the same variable will change in the future."/>


<meta property="og:title" content="LSTM for time-series forecasting: predicting wind-power generation" />
<meta property="og:description" content="Time-series forecasting has tons of applications. If we have a record of how something has changed with time in the past, the next step is often to wonder about how the same variable will change in the future." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://k-olsen.github.io/projects/wind_power_forecasting_project_post/" /><meta property="og:image" content="https://k-olsen.github.io/images/profile.png"/><meta property="article:section" content="projects" />
<meta property="article:published_time" content="2021-08-24T01:00:40-04:00" />
<meta property="article:modified_time" content="2021-08-24T01:00:40-04:00" /><meta property="og:site_name" content="Kira Olsen, Ph.D." />




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type":"Person",
      "@id": "https://k-olsen.github.io/#author",
      "name":  null ,
      "image": {
        "@type":"ImageObject",
        
        "url": "https://k-olsen.github.io/images/kira_headshot3_lowerres.jpg"
        
      },
      "description": "Data Scientist"
    },
    {
      "@type": "WebSite",
      "@id": "https://k-olsen.github.io/#website",
      "url": "https://k-olsen.github.io/",
      "name": "Kira Olsen, Ph.D.",
      "description": "Data Scientist",
      "publisher": {
        "@id": "https://k-olsen.github.io/#author"
      },
      "inLanguage": "en"
    },
    {
      "@type": "ImageObject",
      "url": "https://k-olsen.github.io/images/profile.png",
      "caption": "Kira Olsen, Ph.D."
    },
    {
      "@type": "WebPage",
      "@id": "https://k-olsen.github.io/projects/wind_power_forecasting_project_post/#webpage",
      "url": "https://k-olsen.github.io/projects/wind_power_forecasting_project_post/",
      "name": "LSTM for time-series forecasting: predicting wind-power generation",
      "isPartOf": {
        "@id": "https://k-olsen.github.io/#website"
      },
      "about": {
         "@id": "https://k-olsen.github.io/#author"
      },
      "datePublished": "2021-08-24T01:00:40-04:00",
      "dateModified": "2021-08-24T01:00:40-04:00",
      "description": "Time-series forecasting has tons of applications. If we have a record of how something has changed with time in the past, the next step is often to wonder about how the same variable will change in the future.",
      "inLanguage": "en",
      "potentialAction": [
        {
          "@type": "ReadAction",
          "target": [
            "https://k-olsen.github.io/projects/wind_power_forecasting_project_post/"
          ]
        }
      ]
    },
    {
      "@type": "Article",
      "isPartOf": {
        "@id": "https://k-olsen.github.io/projects/wind_power_forecasting_project_post/#webpage"
      },
      "mainEntityOfPage": {
        "@id": "https://k-olsen.github.io/projects/wind_power_forecasting_project_post/#webpage"
      },
      "headline": "LSTM for time-series forecasting: predicting wind-power generation",
      "datePublished": "2021-08-24T01:00:40-04:00",
      "dateModified": "2021-08-24T01:00:40-04:00",
      "publisher": {
        "@id": "https://k-olsen.github.io/#author"
      },
      "keywords": [
      ],
      "articleSection": [
      ],
      "inLanguage": "en",
      "author": {
        "@type": "Person",
        "name":  null 
      },
      "potentialAction": [
        {
          "@type": "CommentAction",
          "name": "Comment",
          "target": [
            "https://k-olsen.github.io/projects/wind_power_forecasting_project_post/#comments"
          ]
        }
      ]
    }
  ]
}
</script>



  <link type="text/css"
        rel="stylesheet"
        href="/css/print.css"
        media="print">

  <link type="text/css"
        rel="stylesheet"
        href="/css/poole.css">

  <link type="text/css"
        rel="stylesheet"
        href="/css/hyde.css">

  


  

  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap">

  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
        integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
        crossorigin="anonymous" />

  <link rel="apple-touch-icon-precomposed"
        sizes="144x144"
        href="/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/favicon.png">

  
  </head>
<body>
  <aside class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      
        
        <div class="author-image">
          <a href="https://k-olsen.github.io/">
            <img src="/images/kira_headshot3_lowerres.jpg" class="img-circle img-headshot center" alt="Profile Picture">
          </a>
        </div>
        
      

      <h1>Kira Olsen, Ph.D.</h1>

      
      <p class="lead">Data Scientist</p>
      
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li>
          <a href="https://k-olsen.github.io/">Home</a>
        </li>
        <li>
          <a href="/about/">About</a>
        </li><li>
          <a href="/projects/">Projects</a>
        </li>
      </ul>
    </nav>

    <section class="social-icons">
      
      <a href="https://github.com/k-olsen" rel="me" title="GitHub" target="_blank">
        <i class="fab fa-github" aria-hidden="true"></i>
      </a>
      
      <a href="https://www.linkedin.com/in/kira-olsen/" rel="me" title="Linkedin" target="_blank">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
      
      <a href="https://scholar.google.com/citations?hl=en&amp;user=BLEOIPEAAAAJ&amp;view_op=list_works&amp;sortby=pubdate" rel="me" title="GoogleScholar" target="_blank">
        <i class="fab fa-google" aria-hidden="true"></i>
      </a>
      
    </section>
  </div>
</aside>


  <main class="content container">
  <div class="post">
  <h1 class="title">LSTM for time-series forecasting: predicting wind-power generation</h1>
  

  <div class="post-date">
    <time datetime="2021-08-24T01:00:40-0400">Aug 24, 2021</time> <span class="readtime">&middot; 5 min read</span>
  </div>

  <div>
  <p>Time-series forecasting has tons of applications. If we have a record of how something has changed with time in the past, the next step is often to wonder about how the same variable will change in the future.</p>
<p>In this post I&rsquo;m going to tackle time-series forecasting using a powerful machine-learning technique called a Long Short-Term Memory network, or LSTM for short. LSTM are a form of recurrent neural network (RNN). Like all neural networks, RNNs are built with a layered structure between the input and output nodes (I describe this a bit in my post on CNNs). The &lsquo;recurrent&rsquo; part of their name arises from the fact that they include connections between neurons that loop back to previous layers before passing information forward again. This design allows RNNs to gain memory, and to learn sequences of inputs (like time series), rather than just fixed patterns.</p>
<p><img src="/projects/LSTM_wind_power_forecasting/LSTM3-chain.png" alt="diagram"> <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/"><em>Image Credit: Christopher Olah</em></a></p>
<p>The theory behind LSTM networks is beautiful, but complex. <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">This is a nice overview</a> if you are interested in diving in. I also find <a href="https://towardsdatascience.com/illustrated-guide-to-lstms-and-gru-s-a-step-by-step-explanation-44e9eb85bf21">the videos in this article helpful</a> in understanding how information passes through an LSTM network.</p>
<h3 id="the-question-how-much-wind-power-did-germany-generate-in-2020">The question: how much wind power did Germany generate in 2020?</h3>
<p><img src="/projects/LSTM_wind_power_forecasting/german_windmills.png" alt="Windmills"> <em>Image Credit: CleanEnergyWire.org</em></p>
<p>The question of energy forecasting is a great one for us to tackle. Having a prediction of future power generation levels is useful for many different groups, especially given the intermittent nature of wind power. A long history (hundreds of days of data) to work with, like we have with this dataset, sets us up with the information we need to implement our forecasting.</p>
<p>To test out our LSTM network I&rsquo;ve downloaded a <a href="https://www.kaggle.com/jorgesandoval/wind-power-generation">dataset</a> of wind-power generation in Germany. The dataset contains values for power generation by four different companies, or transmission operators. Here I&rsquo;m going to focus on the wind power generated by a single company, <a href="https://www.amprion.net/Amprion/index-2.html">Ampiron</a>.</p>
<h3 id="the-dataset">The Dataset</h3>
<p>Values in this dataset are reported in terrawatt hours in 15-minute time steps. Each 15-minute power-generation value is a country-wide total, representing the sum of power generated by all of Ampiron&rsquo;s wind stations in Germany. The dataset contains 38,112 values documenting power generation between 8/23/2019 and 9/22/2020.</p>
<p>Here are the first few months of data:</p>
<p><img src="/projects/LSTM_wind_power_forecasting/just_wind_data.jpg" alt="short forecast"></p>
<h3 id="data-cleanup">Data Cleanup</h3>
<p>There are no NAN values to deal with here, however I quickly noticed that there are some 0 values in the power time series that look like they may be artifacts. These 0 values occur between much higher values, and there is just a single 0 value at a time, suggesting that they may be missing values (see figure below).</p>
<p>To work around these 0 values I applied a linear interpolation (purple line in figure below), and I use the new, interpolated time series in the rest of this analysis.</p>
<p><img src="/projects/LSTM_wind_power_forecasting/Interpolation_example.jpg" alt="Interpolation"></p>
<h3 id="lstm-network-setup">LSTM network setup</h3>
<p>I am using the Keras library in this project. To keep things simple I built a LSTM network with a single layer, followed by a dense layer before the output.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> keras.models <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> keras.layers <span style="color:#f92672">import</span> LSTM
<span style="color:#f92672">from</span> keras.layers <span style="color:#f92672">import</span> Dense

<span style="color:#75715e"># define model</span>
model <span style="color:#f92672">=</span> Sequential()
model<span style="color:#f92672">.</span>add(LSTM(<span style="color:#ae81ff">50</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>, input_shape<span style="color:#f92672">=</span>(n_steps, n_features)))
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">1</span>))
model<span style="color:#f92672">.</span>compile(optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>, loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mse&#39;</span>)

model<span style="color:#f92672">.</span>fit(X, y, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, verbose <span style="color:#f92672">=</span> True)
</code></pre></div><p>The LSTM layer takes the <em>n_steps</em> input, which specifies how many data points to use in the calculation (prediction) of each new point. I did a grid search through possible values and settled on 8 (e.g., eight 15-minute data points, or 2 hrs of time series). I use this setup for the remainder of this post.</p>
<p>At every step, the LSTM network considers the preceding 8 points (2hrs of data), and uses those 8 points to predict the next point.</p>
<h3 id="results-comparing-forecasts-to-true-values">Results: comparing forecasts to true values</h3>
<p>Here is an example of the model at work! Blue dots below are the true (observed) data values. In this example I have trained the LSTM network on the first 10,000 data points (104 day of 15-min observations). Once trained, the model is fed 8 observations (2 hours of observations) and then predicts the next point. In the demonstration below, the predicted value (red dot) is 51.4 while the true value for observed for this point (blue dot below red) is 49.0, meaning that the model over-predicted the true value.</p>
<p><img src="/projects/LSTM_wind_power_forecasting/8point_forecast.jpg" alt="short forecast"></p>
<p>We can use this approach to continuously predict the wind-power generation 15 minutes ahead. We would do this by feeding the model 2-hour-long windows of data, then making a prediction for the next data point, record the true value, then include that newly observed true value in the next set of 8 data points to predict the following point, etc.</p>
<p><img src="/projects/LSTM_wind_power_forecasting/short_forecast_zoom.png" alt="short forecast zoom"></p>
<p>The figure above shows that we can fit the true data well doing this. The red line above shows the predicted values, compared to the observed values in blue. Remember, the red line is not predicted all at once. Instead, at every moment we are predicting only what will happen 15 minutes out, and adding one more red dot to the figure above.</p>
<h3 id="next-steps">Next Steps</h3>
<p>If we want to predict further ahead than just one time step, we need to modify our LSTM network. This is beyond the scope of this post, but if you&rsquo;re interested I&rsquo;ll say a few words about how it can be done.</p>
<p>The approach I would take to predict more than one time step (say, to predict 1 hr into the future, or 4 time steps) would be to expand upon the LSTM we&rsquo;ve built here would to build an <a href="https://machinelearningmastery.com/encoder-decoder-long-short-term-memory-networks/">encoder-decoder LSTM</a>. Encoder-decoder networks can solve sequence-to-sequence problems, where the output prediction is also a sequence (and not just a single point).</p>
<p>Ultimately, using either an LSTM network as described here or an encoder-decoder LSTM will provide a data-driven prediction of future wind-power generation. These are powerful approaches and only require a time series as input, that is, a record of wind-power generation. A more sophisticated forecasting model could include a physics-driven approach, whereby known information such as how time of day or season generally influences wind speeds, could be included. This approach might yield a more accurate forecasting tool, but would require both an understanding of the variables that influence wind-power generation, and significantly more work than the model presented here.</p>
<p>The code for the analysis and figures in this post can be found <a href="https://github.com/k-olsen/LSTM-wind-forecasting">on my GitHub page</a>.</p>

  </div>

  


  <div class="share-buttons">
  <a class="twitter-share-button"
     href="#"
     title="Share on Twitter"
     data-url="https://k-olsen.github.io/projects/wind_power_forecasting_project_post/"
     data-text="LSTM for time-series forecasting: predicting wind-power generation"><i class="fab fa-twitter"></i></a>

  <a class="linkedin-share-button"
     href="#"
     title="Share on LinkedIn"
     data-url="https://k-olsen.github.io/projects/wind_power_forecasting_project_post/"
     data-text="LSTM for time-series forecasting: predicting wind-power generation"><i class="fab fa-linkedin-in"></i></a>

  <a class="facebook-share-button"
     href="#"
     title="Share on Facebook"
     data-url="https://k-olsen.github.io/projects/wind_power_forecasting_project_post/"
     data-text="LSTM for time-series forecasting: predicting wind-power generation"><i class="fab fa-facebook"></i></a>

  <a class="telegram-share-button"
     href="#"
     title="Share on Telegram"
     data-url="https://k-olsen.github.io/projects/wind_power_forecasting_project_post/"
     data-text="LSTM for time-series forecasting: predicting wind-power generation"><i class="fab fa-telegram"></i></a>

  <a class="pinterest-share-button"
     href="#"
     title="Share on Pinterest"
     data-url="https://k-olsen.github.io/projects/wind_power_forecasting_project_post/"
     data-text="LSTM for time-series forecasting: predicting wind-power generation"><i class="fab fa-pinterest"></i></a>
</div>


  
</div>
  </main>

  <footer>
  <div>
    <p>
      &copy; Kira Olsen 2021

      &middot; <a href="https://creativecommons.org/licenses/by-sa/4.0" target="_blank">CC BY-SA 4.0</a>

      &middot; Build with <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://themes.gohugo.io/soho/" target="_blank">Soho</a> theme
    </p>
  </div>
</footer>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"
          integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0="
          crossorigin="anonymous"></script>


  <script src="/js/jquery.min.js"></script>
  <script src="/js/soho.js"></script>

  

  
</body>
</html>
