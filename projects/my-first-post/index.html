<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Hugo 0.83.1" />

  <title>A convolutional neural network built to detect Antarctic icequakes &middot; Kira Olsen, Ph.D.</title>

  <meta name="description" content="" />

  

<meta itemprop="name" content="A convolutional neural network built to detect Antarctic icequakes">
<meta itemprop="description" content="Just as earthquakes routinely shake the earth in California or Alaska, icequakes occur when ice fractures or shifts within the ice caps at the poles of our planet."><meta itemprop="datePublished" content="2021-05-27T21:00:40-04:00" />
<meta itemprop="dateModified" content="2021-05-27T21:00:40-04:00" />
<meta itemprop="wordCount" content="1034"><meta itemprop="image" content="https://k-olsen.github.io/images/profile.png"/>
<meta itemprop="keywords" content="" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://k-olsen.github.io/images/profile.png"/>

<meta name="twitter:title" content="A convolutional neural network built to detect Antarctic icequakes"/>
<meta name="twitter:description" content="Just as earthquakes routinely shake the earth in California or Alaska, icequakes occur when ice fractures or shifts within the ice caps at the poles of our planet."/>


<meta property="og:title" content="A convolutional neural network built to detect Antarctic icequakes" />
<meta property="og:description" content="Just as earthquakes routinely shake the earth in California or Alaska, icequakes occur when ice fractures or shifts within the ice caps at the poles of our planet." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://k-olsen.github.io/projects/my-first-post/" /><meta property="og:image" content="https://k-olsen.github.io/images/profile.png"/><meta property="article:section" content="projects" />
<meta property="article:published_time" content="2021-05-27T21:00:40-04:00" />
<meta property="article:modified_time" content="2021-05-27T21:00:40-04:00" /><meta property="og:site_name" content="Kira Olsen, Ph.D." />




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type":"Person",
      "@id": "https://k-olsen.github.io/#author",
      "name":  null ,
      "image": {
        "@type":"ImageObject",
        
        "url": "https://k-olsen.github.io/images/kira.jpg"
        
      },
      "description": "Data Scientist"
    },
    {
      "@type": "WebSite",
      "@id": "https://k-olsen.github.io/#website",
      "url": "https://k-olsen.github.io/",
      "name": "Kira Olsen, Ph.D.",
      "description": "Data Scientist",
      "publisher": {
        "@id": "https://k-olsen.github.io/#author"
      },
      "inLanguage": "en"
    },
    {
      "@type": "ImageObject",
      "url": "https://k-olsen.github.io/images/profile.png",
      "caption": "Kira Olsen, Ph.D."
    },
    {
      "@type": "WebPage",
      "@id": "https://k-olsen.github.io/projects/my-first-post/#webpage",
      "url": "https://k-olsen.github.io/projects/my-first-post/",
      "name": "A convolutional neural network built to detect Antarctic icequakes",
      "isPartOf": {
        "@id": "https://k-olsen.github.io/#website"
      },
      "about": {
         "@id": "https://k-olsen.github.io/#author"
      },
      "datePublished": "2021-05-27T21:00:40-04:00",
      "dateModified": "2021-05-27T21:00:40-04:00",
      "description": "Just as earthquakes routinely shake the earth in California or Alaska, icequakes occur when ice fractures or shifts within the ice caps at the poles of our planet.",
      "inLanguage": "en",
      "potentialAction": [
        {
          "@type": "ReadAction",
          "target": [
            "https://k-olsen.github.io/projects/my-first-post/"
          ]
        }
      ]
    },
    {
      "@type": "Article",
      "isPartOf": {
        "@id": "https://k-olsen.github.io/projects/my-first-post/#webpage"
      },
      "mainEntityOfPage": {
        "@id": "https://k-olsen.github.io/projects/my-first-post/#webpage"
      },
      "headline": "A convolutional neural network built to detect Antarctic icequakes",
      "datePublished": "2021-05-27T21:00:40-04:00",
      "dateModified": "2021-05-27T21:00:40-04:00",
      "publisher": {
        "@id": "https://k-olsen.github.io/#author"
      },
      "keywords": [
      ],
      "articleSection": [
      ],
      "inLanguage": "en",
      "author": {
        "@type": "Person",
        "name":  null 
      },
      "potentialAction": [
        {
          "@type": "CommentAction",
          "name": "Comment",
          "target": [
            "https://k-olsen.github.io/projects/my-first-post/#comments"
          ]
        }
      ]
    }
  ]
}
</script>



  <link type="text/css"
        rel="stylesheet"
        href="/css/print.css"
        media="print">

  <link type="text/css"
        rel="stylesheet"
        href="/css/poole.css">

  <link type="text/css"
        rel="stylesheet"
        href="/css/hyde.css">

  


  

  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap">

  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
        integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
        crossorigin="anonymous" />

  <link rel="apple-touch-icon-precomposed"
        sizes="144x144"
        href="/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/favicon.png">

  
  </head>
<body>
  <aside class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      
        
        <div class="author-image">
          <a href="https://k-olsen.github.io/">
            <img src="/images/kira.jpg" class="img-circle img-headshot center" alt="Profile Picture">
          </a>
        </div>
        
      

      <h1>Kira Olsen, Ph.D.</h1>

      
      <p class="lead">Data Scientist</p>
      
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li>
          <a href="https://k-olsen.github.io/">Home</a>
        </li>
        <li>
          <a href="/about/">About</a>
        </li><li>
          <a href="/projects/">Projects</a>
        </li>
      </ul>
    </nav>

    <section class="social-icons">
      
      <a href="https://github.com/k-olsen" rel="me" title="GitHub" target="_blank">
        <i class="fab fa-github" aria-hidden="true"></i>
      </a>
      
      <a href="https://www.linkedin.com/in/kira-olsen-77816a29/" rel="me" title="Linkedin" target="_blank">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
      
      <a href="https://scholar.google.com/citations?hl=en&amp;user=BLEOIPEAAAAJ&amp;view_op=list_works&amp;sortby=pubdate" rel="me" title="GoogleScholar" target="_blank">
        <i class="fab fa-google" aria-hidden="true"></i>
      </a>
      
    </section>
  </div>
</aside>


  <main class="content container">
  <div class="post">
  <h1 class="title">A convolutional neural network built to detect Antarctic icequakes</h1>
  

  <div class="post-date">
    <time datetime="2021-05-27T21:00:40-0400">May 27, 2021</time> <span class="readtime">&middot; 5 min read</span>
  </div>

  <div>
  <p>Just as earthquakes routinely shake the earth in California or Alaska, icequakes occur when ice fractures or shifts within the ice caps at the poles of our planet.  Icequakes are tiny compared to earthquakes, and the vast majority are so small that you wouldn&rsquo;t feel them happening beneath your feet. However, even extremely small icequakes generate seismic waves that can be recorded by seismometers buried in the snow. <!-- raw HTML omitted --></p>
<p>This is what a single icequake looks like. The icequake is the pattern of wiggles centered around 4 seconds on the x-axis, showing us that ground motion occurs at that time.
<img src="/projects/icequake_CNN/20141201144621_waveform_w_axes.jpg" alt="icequake seismogram"></p>
<p>Why go to the trouble of recording icequakes? Icequakes are generated when ice changes in some way, and scientists are really interested in understanding how polar ice is changing, especially given that the north and south poles are some of the <a href="https://www.nasa.gov/topics/earth/features/warmingpoles.html">most rapidly changing places on Earth</a>. When instruments listen for icequakes they are giving us an ear to what is happening within the ice, whether it be ice shifting, cracking, or sliding. Scientists use this icequake data to understand the physics of ice deformation. <!-- raw HTML omitted --></p>
<p>The data I used in this project was recorded by <a href="http://ds.iris.edu/mda/XH/DR14/">a seismometer installed on the Ross Ice Shelf in Antarctica</a>. The ice shelf is identified on this map in blue.</p>
<p><img src="/projects/icequake_CNN/RIS_map_of_Antarctica_v2.jpg" alt="RIS map"></p>
<p>Here, again, is our example icequake seismogram:</p>
<p><img src="/projects/icequake_CNN/20141201144621_waveform_w_axes.jpg" alt="icequake seismogram"></p>
<p>Compare that seismogram to the figure below, which shows noise and no clear signal. Seismometers record continuously, so they are often capturing data during times when no icequakes are happening, resulting in a lot of data that looks like this, and isn&rsquo;t useful for our purposes.</p>
<p><img src="/projects/icequake_CNN/20150312092656_noise_waveform_w_axes.jpg" alt="noisy seismogram"></p>
<p>The goal of my CNN will be to distinguish between seismic signals and seismic noise. One seismometer recording continuously for one year generates terrabytes of data, and before we can investigate anything about the icequakes recorded we need some way of scanning through all that data to separate the icequakes from the noise. This is a great task for machine learning, and I&rsquo;ve chosen to employ a convolutional neural network (CNN) for the task. <!-- raw HTML omitted --></p>
<p>A <a href="https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53">CNN</a> is a deep-learning algorithm that excels at taking some kind of data input and assigning a classification to it. CNNs are commonly used to differentiate images (does this photo show a car or a bike?), as well as in applications like handwriting recognition. CNNs are now being used in scientific applications as well, including signal detection.</p>
<p>I thought a CNN could be a powerful tool for icequake identification.</p>
<!-- raw HTML omitted -->
<h3 id="cnn-setup">CNN Setup</h3>
<p>Because a CNN is a supervised-learning technique, we need to train the algorithm on a dataset of already labeled data. In this case I used 8-second seismograms (like those shown above) labeled either as an &lsquo;event&rsquo; or as &lsquo;noise&rsquo;. The training events were detected using a simple method called short-term-average/long-term-average <a href="https://www.guralp.com/documents/html/MAN-D16-0001/s4.html">(STA/LTA)</a> detection, which is a way to scan through continuous time series and identify times when energy is elevated, which is then coded as an event. It&rsquo;s a computationally efficient approach, but has drawbacks, for example if multiple events happen close in time energy may already be elevated from the first event, causing the detector to miss the second event. <!-- raw HTML omitted --></p>
<h4 id="training-data">Training Data</h4>
<p>I assembled a training dataset that consisted of 12,000 icequakes and 12,000 windows of seismic record that consisted only of noise (no icequakes). Each of these 24,000 event or noise windows was 8 seconds long, and consisted of three-component data (an E-W component, N-S component, and up-down component). I used a 75/25 split for training, meaning that the CNN trained on 18,000 windows and held 6,000 windows out for validation.</p>
<h4 id="cnn-architecture">CNN Architecture</h4>
<p>I built the convolutional neural network using a combination of 2D convolutional layers and max-pooling layers, with dropout layers interspersed to prevent overfitting of the data. Here is the architecture of the CNN, built using keras:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model <span style="color:#f92672">=</span> Sequential()
model<span style="color:#f92672">.</span>add(Conv2D(filters <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>, kernel_size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">21</span>),
      activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>, input_shape<span style="color:#f92672">=</span>input_shape))
model<span style="color:#f92672">.</span>add(MaxPooling2D(pool_size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>)))
model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.5</span>))

model<span style="color:#f92672">.</span>add(Conv2D(<span style="color:#ae81ff">64</span>, (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">15</span>), activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(MaxPooling2D(pool_size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>)))
model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.5</span>))

model<span style="color:#f92672">.</span>add(Conv2D(<span style="color:#ae81ff">128</span>, (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>), activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(MaxPooling2D(pool_size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>)))
model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.5</span>))

model<span style="color:#f92672">.</span>add(Conv2D(<span style="color:#ae81ff">256</span>, (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>), activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(MaxPooling2D(pool_size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>)))
model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.5</span>))

model<span style="color:#f92672">.</span>add(Flatten())
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">200</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(BatchNormalization())
model<span style="color:#f92672">.</span>add(Dense(num_classes, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sigmoid&#39;</span>))

</code></pre></div><p>For the hyperparameters for my model I opted to use a batch size of 128, and to train the model for 100 epochs. I used ReLU activation functions throughout, with the exception of a sigmoid activation function in the last layer because my output is a binary classification (event vs. noise).
<!-- raw HTML omitted --></p>
<p>Once my model was constructed, I split out my test and training data and fit the model. <!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
x_train, x_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(combined_array, combined_key, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>, shuffle <span style="color:#f92672">=</span> True)


opt <span style="color:#f92672">=</span> keras<span style="color:#f92672">.</span>optimizers<span style="color:#f92672">.</span>Adam()
model<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span>keras<span style="color:#f92672">.</span>losses<span style="color:#f92672">.</span>binary_crossentropy,
              optimizer<span style="color:#f92672">=</span> opt,
              metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;accuracy&#39;</span>])


history <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(x_train, y_train,
          batch_size<span style="color:#f92672">=</span>batch_size,
          epochs<span style="color:#f92672">=</span>num_epochs,
          verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,
          validation_data<span style="color:#f92672">=</span>(x_test, y_test))


</code></pre></div><p>While this model can be trained on a laptop, for increased speed and testing capabilities I trained it using the HPC cluster <em>Deepthought2</em> at the University of Maryland.</p>
<h3 id="model-performance">Model Performance</h3>
<p><img src="/projects/icequake_CNN/model_1D_100epochs_4812test_19248train_accuracy.png" alt="Model Accuracy Plot">
<img src="/projects/icequake_CNN/model_1D_100epochs_4812test_19248train_loss.png" alt="Model Loss Plot"></p>
<p>The model converges nicely, and the validation accuracy levels off after around 40 epochs. <!-- raw HTML omitted --></p>
<p>Here is the confusion matrix, which shows us the number of items correctly and incorrectly classified by the model. As you can see, the model incorrectly classifies an event as noise (17 times) more often than it classifies noise as an event (2 times). <!-- raw HTML omitted --> <!-- raw HTML omitted --></p>
<p><img src="/projects/icequake_CNN/confusion_matrix.jpg" alt="Confusion matrix"></p>
<h3 id="results">Results</h3>
<p><img src="/projects/icequake_CNN/CNN_and_STA_DR14_3month_detections_hist2.jpg" alt="Confusion matrix"></p>
<p>The CNN performs well, detecting around twice as many seismic events as the traditional technique!</p>
<p>I ran the CNN on three months of continuous seismic data, and the CNN detected 1791 icequakes, whereas the old technique detected only 931.</p>
<p>A cool scientific result to come out of this analysis is how clearly the events detected by the CNN are linked with tidal phase. The highest number of icequakes occur during falling tide. In the figure above I have organized the number of icequakes detected using each technique by the phase of the tide when each icequake occurred. Blue lines show the height of the ocean tide (each day&rsquo;s tidal cycle varies slightly, hence the range of blue lines) stacked atop each other. Crimson bars (CNN detections) show a clear increase during falling tide. This can also be seen in the grey bars (old detection technique), but it is not as pronounced.</p>
<p>The results of this CNN detector are exciting. By greatly expanding our catalog of icequakes this detection technique will enable new scientific investigation into ice-sheet stability.</p>

  </div>

  


  <div class="share-buttons">
  <a class="twitter-share-button"
     href="#"
     title="Share on Twitter"
     data-url="https://k-olsen.github.io/projects/my-first-post/"
     data-text="A convolutional neural network built to detect Antarctic icequakes"><i class="fab fa-twitter"></i></a>

  <a class="linkedin-share-button"
     href="#"
     title="Share on LinkedIn"
     data-url="https://k-olsen.github.io/projects/my-first-post/"
     data-text="A convolutional neural network built to detect Antarctic icequakes"><i class="fab fa-linkedin-in"></i></a>

  <a class="facebook-share-button"
     href="#"
     title="Share on Facebook"
     data-url="https://k-olsen.github.io/projects/my-first-post/"
     data-text="A convolutional neural network built to detect Antarctic icequakes"><i class="fab fa-facebook"></i></a>

  <a class="telegram-share-button"
     href="#"
     title="Share on Telegram"
     data-url="https://k-olsen.github.io/projects/my-first-post/"
     data-text="A convolutional neural network built to detect Antarctic icequakes"><i class="fab fa-telegram"></i></a>

  <a class="pinterest-share-button"
     href="#"
     title="Share on Pinterest"
     data-url="https://k-olsen.github.io/projects/my-first-post/"
     data-text="A convolutional neural network built to detect Antarctic icequakes"><i class="fab fa-pinterest"></i></a>
</div>


  
</div>
  </main>

  <footer>
  <div>
    <p>
      &copy; Kira Olsen 2021

      &middot; <a href="https://creativecommons.org/licenses/by-sa/4.0" target="_blank">CC BY-SA 4.0</a>

      &middot; Build with <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://themes.gohugo.io/soho/" target="_blank">Soho</a> theme
    </p>
  </div>
</footer>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"
          integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0="
          crossorigin="anonymous"></script>


  <script src="/js/jquery.min.js"></script>
  <script src="/js/soho.js"></script>

  

  
</body>
</html>
